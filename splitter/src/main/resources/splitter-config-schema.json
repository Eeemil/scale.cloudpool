{
  "id": "http://elastisys.com/splitter-adapter-schema#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "description": "configuration schema for the Splitter cloud adapter",
  "definitions": {
    "basicCredentials": {
        "type": "object",
        "properties": {
            "username": { "type": "string" },
            "password": { "type": "string" }
        },
        "required": [ "username", "password" ]
    },
    "certificateCredentials": {
        "type": "object",
        "properties": {
            "keystorePath": { "type": "string" },
            "keystorePassword": { "type": "string" },
            "keyPassword": { "type": "string" },
            "keystoreType": { "enum": ["PKCS12", "JKS"]}
        },
        "required": [ "keystorePath", "keystorePassword", "keystoreType" ]
    },
    "adapterEndpoint": {
        "type": "object",
        "properties": {
            "cloudAdapterHost": { "type": "string" },
            "cloudAdapterPort": { "type": "number", "minimum": 1, "maximum": 65535 }
        },
        "required": [ "cloudAdapterHost", "cloudAdapterPort" ]
    },
    "priority": { "type": "number", "minimum": 0, "maximum": 100 },    
    "poolSizeCalculator": { "enum": [ "STRICT" ] },
    "poolUpdatePeriod": {
        "description": "The time interval (in seconds) between pushing out the desired size to each child adapter.",
        "type": "number",
        "minimum": 0
    }
  },
  "type": "object",
  "title": "SplitterConfig",
  "properties": {
    "$ref": "#/definitions/poolSizeCalculator",
    "adapters": {
        "description": "Describes the set of back-end cloud adapters and their respective priorities.",
        "type": "array",
        "items": {
          "allOf": [
              { "$ref": "#/definitions/priority" },
              { "$ref": "#/definitions/adapterEndpoint" },
              {
                "anyOf": [
                    { "$ref": "#/definitions/basicCredentials" },
                    { "$ref": "#/definitions/certificateCredentials" }
                ]
              }
          ]
        },
        "minItems": 1,
        "uniqueItems": true
      }
    },
    "$ref": "#/definitions/poolUpdatePeriod",    
    "required": [ "poolSizeCalculator", "adapters" ]
}
